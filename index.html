<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Milioner</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Layar Awal (Tidak ada perubahan) -->
    <div id="start-screen" class="screen active">
        <div class="start-box">
            <img src="logo.png" 
                 alt="Logo Kuis" 
                 class="logo-spinning" 
                 onerror="this.onerror=null; this.src='https://placehold.co/150x150/0c0c2c/ffc107?text=LOGO';">
            
            <div id="custom-game-info" class="hidden">
                <h3>Mode Kuis Kustom</h3>
                <p id="custom-game-status">Memuat soal...</p>
            </div>
            <div id="player-controls">
                <h2>Mulai Bermain</h2>
                <input type="text" id="player-name-input" placeholder="Masukkan nama Anda">
                <div id="fase-select-container">
                    <select id="fase-select">
                        <option value="A">Fase A (Default)</option>
                        <option value="B">Fase B (Default)</option>
                        <option value="C">Fase C (Default)</option>
                        <option value="D">Fase D (Default)</option>
                        <option value="E">Fase E (Default)</option>
                        <option value="F">Fase F (Default)</option>
                    </select>
                </div>
                <button id="start-game-btn">Mulai Bermain</button>
            </div>
            <hr id="host-separator">
            <div id="host-controls">
                <button id="toggle-host-btn">Panel Host (Buat Kuis)</button>
                <div id="host-panel" class="hidden">
                    <p>Tempelkan link Google Sheet (yang sudah dipublikasi sebagai CSV):</p>
                    <input type="text" id="google-sheet-input" placeholder="https.../pub?output=csv">
                    <button id="generate-link-btn">Buat Link Game</button>
                    <a href="#" id="how-to-csv-link" class="how-to-link">Bagaimana caranya?</a>
                </div>
            </div>
            <hr class="host-hr">
            <div id="view-scores-controls">
                <h3>Lihat Hasil Kuis Kustom</h3>
                <p>Masukkan ID Kuis Anda (bagian setelah #):</p>
                <input type="text" id="view-quiz-id-input" placeholder="aBcDeFg123">
                <button id="view-scores-btn">Tampilkan Skor</button>
            </div>

            <!-- Modal Petunjuk (Tidak berubah) -->
            <div id="how-to-modal" class="modal-overlay"> <div class="modal-content-small"> ... </div> </div>
            <!-- Modal Link Kustom (Tidak berubah) -->
            <div id="share-link-modal" class="modal-overlay"> <div class="modal-content-small"> ... </div> </div>

            <!-- ***** PERUBAHAN DI SINI ***** -->
            <!-- Modal Tampilan Skor Host (Tombol Baru Ditambahkan) -->
            <div id="score-view-modal" class="modal-overlay">
                <div class="modal-content-large">
                    <h3>Hasil Kuis Kustom</h3>
                    <p id="score-view-title">Leaderboard untuk Kuis ID: ...</p>
                    <div class="table-container">
                        <!-- ID 'score-table' PENTING untuk export -->
                        <table id="score-table">
                            <thead>
                                <tr>
                                    <th>Peringkat</th>
                                    <th>Nama</th>
                                    <th>Skor</th>
                                    <th>Tanggal</th>
                                </tr>
                            </thead>
                            <tbody id="score-table-body"></tbody>
                        </table>
                    </div>
                    <!-- Tombol dibungkus di 'modal-footer' untuk layout -->
                    <div class="modal-footer">
                        <button id="export-excel-btn">Export ke Excel (.xlsx)</button>
                        <button id="close-score-view-btn">Tutup</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Layar Permainan (Tidak ada perubahan) -->
    <div id="game-screen" class="screen">
        <div class="game-container">
            <div class="quiz-main">
                <div class="top-bar">...</div>
                <div class="qa-container">
                    <div id="question-container">...</div>
                    <div id="options-container">
                        <div class="option" data-option="A">...</div>
                        <div class="option" data-option="B">...</div>
                        <div class="option" data-option="C">...</div>
                        <div class="option" data-option="D">...</div>
                    </div>
                </div>
            </div>
            <div class="prize-ladder-container">...</div>
        </div>
        <!-- Modal Konfirmasi (Tidak berubah) -->
        <div id="confirm-modal" class="modal-overlay"> ... </div>
        <!-- Modal Bantuan Telepon (Tidak berubah) -->
        <div id="phone-modal" class="modal-overlay"> ... </div>
    </div>

    <!-- Elemen Audio (Tidak berubah) -->
    <audio id="opening-audio" src="opening.mp3"></audio>
    <audio id="bg-audio" src="musik.mp3" loop></audio>
    <audio id="correct-audio" src="benar.mp3"></audio>
    <audio id="wrong-audio" src="salah.mp3"></audio>

    <!-- ***** SCRIPT BARU DITAMBAHKAN DI SINI ***** -->
    <!-- Library SheetJS (xlsx.js) untuk membuat file Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>

    <!-- Script game Anda (HARUS setelah library SheetJS) -->
    <script type="module" src="script.js"></script>
</body>
</html>
